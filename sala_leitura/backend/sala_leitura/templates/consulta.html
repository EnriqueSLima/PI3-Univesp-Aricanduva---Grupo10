{% extends 'base.html' %}
{% load static %}

{% block head %}
    <script src="{% static 'sala_leitura/js/cadastro.js' %}"></script>
    <script>
    function exibirLista() {
        // Esconde todas as listas
        document.querySelectorAll('.listagem').forEach(div => {
            div.style.display = 'none';
        });
        
        // Mostra a lista selecionada
        const modelo = document.getElementById('model').value;
        if (modelo) {
            document.getElementById('list-' + modelo).style.display = 'block';
            // Atualiza a URL sem recarregar a página
            window.history.pushState({}, '', `?modelo=${modelo}`);
        }
    }
    
    // Exibe a lista correta ao carregar a página com parâmetro modelo
    document.addEventListener('DOMContentLoaded', function() {
        const urlParams = new URLSearchParams(window.location.search);
        const modelo = urlParams.get('modelo');
        if (modelo) {
            document.getElementById('model').value = modelo;
            exibirLista();
        }
    });
    </script>
{% endblock head %}

{% block content %}
<div class="card border-0 shadow-sm">
    <div class="card-header bg-white border-bottom">
        <h3 class="mb-0">Consultas</h3>
    </div>
    <div class="card-body">
        <form class="select">
            <label for="model">Escolha o que deseja consultar:</label>
            <select id="model" name="model" class="form-control" onchange="exibirLista()">
                <option value="">Selecione...</option>
                <option value="livros" {% if modelo == 'livros' %}selected{% endif %}>Livros</option>
                <option value="alunos" {% if modelo == 'alunos' %}selected{% endif %}>Alunos</option>
                <option value="editoras" {% if modelo == 'editoras' %}selected{% endif %}>Editoras</option>
                <option value="categorias" {% if modelo == 'categorias' %}selected{% endif %}>Categorías</option>
                <option value="emprestimos" {% if modelo == 'emprestimos' %}selected{% endif %}>Empréstimos</option>
            </select>
        </form>

        <!-- Listas de Consulta -->
        <div id="list-livros" class="listagem mt-3" style="display:{% if modelo == 'livros' %}block{% else %}none{% endif %};">
            {% include 'lista_livros.html' %}
        </div>
        <div id="list-alunos" class="listagem mt-3" style="display:{% if modelo == 'alunos' %}block{% else %}none{% endif %};">
            {% include 'lista_alunos.html' %}
        </div>
        <div id="list-editoras" class="listagem mt-3" style="display:{% if modelo == 'editoras' %}block{% else %}none{% endif %};">
            {% include 'lista_editoras.html' %}
        </div>
        <div id="list-categorias" class="listagem mt-3" style="display:{% if modelo == 'categorias' %}block{% else %}none{% endif %};">
            {% include 'lista_categorias.html' %}
        </div>
        <div id="list-emprestimos" class="listagem mt-3" style="display:{% if modelo == 'emprestimos' %}block{% else %}none{% endif %};">
            {% include 'lista_emprestimos.html' %}
        </div>
    </div>
</div>
{% endblock content %}